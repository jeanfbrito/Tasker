<%= render "shared/breadcrumb"%>
<div class="span7" style="margin: 0;">

  <!-- <p id="notice"><%= notice %></p> -->
  <% flash.each do |name, msg| %>
    <% if msg.is_a?(String) %>
      <div class="alert alert-<%= name == :notice ? "success" : "error" %>">
        <a class="close" data-dismiss="alert">&#215;</a>
        <%= content_tag :div, msg, :id => "flash_#{name}" %>
      </div>
    <% end %>
  <% end %>

  <div class="well" style="padding: 8px 0; background: white; padding: 10px;">

    <%= link_to 'Edit', "#editTask", :data => { :url => edit_task_path(@task), :toggle => "modal" }, :class => "edit-task-button" %> |
    <% if @task.parent %>
      <%= link_to 'Back', @task.parent %>
    <% else %>
      <%= link_to 'Back', @task.project %>
    <% end %>
    <div style="float: right">
      <a href="#" class="btn btn-small"><i class="icon-play"></i> </a>
  <a href="#" class="btn btn-small"><i class="icon-pause"></i> </a>
  <a href="#" class="btn btn-small"><i class="icon-stop"></i> </a>
  <a href="#" class="btn btn-small"><i class="icon-ok"></i> </a>

  <a href="#" class="btn btn-small btn-primary"><i class="icon-play icon-white"></i> </a>
  <a href="#" class="btn btn-small btn-warning"><i class="icon-pause"></i> </a>
  <a href="#" class="btn btn-small btn-danger"><i class="icon-stop"></i> </a>
  <a href="#" class="btn btn-small btn-success"><i class="icon-ok"></i> </a>
</div>
    <h1>
      <%= @task.title %>  
    </h1>


    <ul id="myTab" class="nav nav-tabs">
      <li class="active"><a href="#tasks" data-toggle="tab">Tasks</a></li>
      <li class=""><a href="#description" data-toggle="tab">Description</a></li>            
      <li class=""><a href="#files" data-toggle="tab">Attached Files</a></li>            
      <li class=""><a href="#history" data-toggle="tab">History</a></li>

    </ul>
    <div id="myTabContent" class="tab-content">
      <div class="tab-pane fade  active in" id="tasks">
        
        <a href="#newTask" data-url="<%= new_task_path(:parent_id => @task.id, :project_id => @task.project.id)%>" data-toggle="modal" class="new-task-button"><i class="icon-plus"></i> New Task</a>

        <% if @task.have_subtasks? %>
        <%= render "subtasks" %>
        <% end %>

        <h3>
          Completed Tasks
        </h3>
        <ul class="tasks done">
          <li>
            <i class="icon-ok"></i> <span class="title">Wash the Car</span> <span class="meta">Completed <em>2 days ago</em> by <em>John</em></span>
          </li>
          <li>
            <i class="icon-ok"></i> <span class="title">Call the plumber</span> <span class="meta">Completed <em>5 days ago</em> by <em>John</em></span>
          </li>
          <li>
            <i class="icon-ok"></i> <span class="title">Try that new cookie recipe</span> <span class="meta">Completed <em>2 weeks ago</em> by <em>Jill</em></span>
          </li>
        </ul>
      </div>
      <div class="tab-pane fade" id="description">
        <p><%= raw @task.description %></p>
      </div>
      <div class="tab-pane fade" id="files">
        <p>Raw denim you probably haven't heard of them jean shorts Austin. Nesciunt tofu stumptown aliqua, retro synth master cleanse. Mustache cliche tempor, williamsburg carles vegan helvetica. Reprehenderit butcher retro keffiyeh dreamcatcher synth. Cosby sweater eu banh mi, qui irure terry richardson ex squid. Aliquip placeat salvia cillum iphone. Seitan aliquip quis cardigan american apparel, butcher voluptate nisi qui.</p>
      </div>
      <div class="tab-pane fade" id="history">
        <table class="table table-striped table-condensed table-bordered">

          <a href="#changeTaskStatus" data-url="<%= new_task_history_path(:task_id => @task.id, :user_id => current_user.id)%>" data-toggle="modal" class="new-task_history-button"><i class="icon-plus"></i> Change Status</a>
          
        <%= render "changehistory"%>  
      </div>
    </div>
  </div>
</div>

<%= render "shared/statusbar"%>

<!-- Modal -->
<div id="editTask" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3>Editing Task</h3>
  </div>
  <div class="modal-body">
    Carregando...
  </div>
</div>

<div id="newTask" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3>New Task</h3>
  </div>
  <div class="modal-body">
    Carregando...
  </div>
</div>

<div id="changeTaskStatus" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3>Change Status</h3>
  </div>
  <div class="modal-body">
    Carregando...
  </div>
</div>